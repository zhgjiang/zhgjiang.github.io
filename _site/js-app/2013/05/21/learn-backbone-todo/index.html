
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>learn backbone todo</title>
    <meta name="description" content="backbone todo mvc">
    <meta name="author" content="crazyjune">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/css/1.4.0/bootstrap.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->
  </head>

  <body>

    <div class="topbar">
      <div class="fill">
        <div class="container">
          <a class="brand" href="/">CrazyJune</a>
          <ul class="nav">
            
            
            


	
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
	
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
	
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
	
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
	
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
	
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
	
		
			
		
			
		
			
		
			
		
							
				
					
						
						<li><a href="/tags.html">标签</a></li>
						
					
				
			
		
			
		
			
		
			
		
			
		
	
		
			
		
			
		
			
		
			
		
			
		
							
				
					
						
						<li><a href="/categories.html">分类</a></li>
						
					
				
			
		
			
		
			
		
			
		
	
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
							
				
					
						
						<li><a href="/js-projects.html">实验</a></li>
						
					
				
			
		
	
		
			
		
			
		
			
		
			
		
			
		
			
		
							
				
					
						
						<li><a href="/archive.html">归档</a></li>
						
					
				
			
		
			
		
			
		
	
		
			
		
							
				
					
						
						<li><a href="/pages.html">站内页面</a></li>
						
					
				
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
	

	
						
			
				
			
		
	
		
	
						
			
				
			
		
	
						
			
				
			
		
	
		
	
		
	
		
	
						
			
				
			
		
	
		
	





          </ul>
        </div>
      </div>
    </div>

    <div class="container">

      <div class="content">
        
<div class="page-header">
  <h1>learn backbone todo <small>Supporting tagline</small></h1>
</div>

<div class="row">
  <div class="span10">
    <h2>Backbone</h2>

<ul>
<li>Events</li>
<li>Model</li>
<li>Collection</li>
<li>Router</li>
<li>History</li>
<li>Sync</li>
<li>View</li>
</ul>

<p>参考文档：<a href="http://backbonejs.org">Backbone</a></p>

<h2>ToDo</h2>

<p>依赖： 
            json2.js
            jQuery.js
            underscore.js
            backbone.js
            backbone.localStorage.js</p>

<h3>Todo</h3>

<p>Todo数据模型，每个Todo实例表示一项待办事项</p>

<div class="highlight"><pre><code class="javascript">  <span class="c1">// Todo Model</span>
  <span class="c1">// ----------</span>

  <span class="c1">// Our basic **Todo** model has `title`, `order`, and `done` attributes.</span>
  <span class="kd">var</span> <span class="nx">Todo</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

    <span class="c1">// Default attributes for the todo item.</span>
    <span class="nx">defaults</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;empty todo...&quot;</span><span class="p">,</span>
        <span class="nx">order</span><span class="o">:</span> <span class="nx">Todos</span><span class="p">.</span><span class="nx">nextOrder</span><span class="p">(),</span>
        <span class="nx">done</span><span class="o">:</span> <span class="kc">false</span>
      <span class="p">};</span>
    <span class="p">},</span>

    <span class="c1">// Toggle the `done` state of this todo item.</span>
    <span class="nx">toggle</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span><span class="nx">done</span><span class="o">:</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;done&quot;</span><span class="p">)});</span>
    <span class="p">}</span>

  <span class="p">});</span>
</code></pre></div>

<h3>TodoList</h3>

<p>TodoList 管理Todo对象的容器，利用localStorage存储数据</p>

<div class="highlight"><pre><code class="javascript"><span class="c1">// Todo Collection</span>
  <span class="c1">// ---------------</span>

  <span class="c1">// The collection of todos is backed by *localStorage* instead of a remote</span>
  <span class="c1">// server.</span>
  <span class="kd">var</span> <span class="nx">TodoList</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collection</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

    <span class="c1">// Reference to this collection&#39;s model.</span>
    <span class="nx">model</span><span class="o">:</span> <span class="nx">Todo</span><span class="p">,</span>

    <span class="c1">// Save all of the todo items under the `&quot;todos-backbone&quot;` namespace.</span>
    <span class="nx">localStorage</span><span class="o">:</span> <span class="k">new</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">LocalStorage</span><span class="p">(</span><span class="s2">&quot;todos-backbone&quot;</span><span class="p">),</span>

    <span class="c1">// Filter down the list of all todo items that are finished.</span>
    <span class="nx">done</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">where</span><span class="p">({</span><span class="nx">done</span><span class="o">:</span> <span class="kc">true</span><span class="p">});</span>
    <span class="p">},</span>

    <span class="c1">// Filter down the list to only todo items that are still not finished.</span>
    <span class="nx">remaining</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">without</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">done</span><span class="p">());</span>
    <span class="p">},</span>

    <span class="c1">// We keep the Todos in sequential order, despite being saved by unordered</span>
    <span class="c1">// GUID in the database. This generates the next order number for new items.</span>
    <span class="nx">nextOrder</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">last</span><span class="p">().</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;order&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="c1">// Todos are sorted by their original insertion order.</span>
    <span class="nx">comparator</span><span class="o">:</span> <span class="s1">&#39;order&#39;</span>

  <span class="p">});</span>
</code></pre></div>

<h3>TodoView</h3>

<p>TodoView Todo的DOM模型， 依赖html模板引擎</p>

<div class="highlight"><pre><code class="javascript"><span class="c1">// Todo Item View</span>
  <span class="c1">// --------------</span>

  <span class="c1">// The DOM element for a todo item...</span>
  <span class="kd">var</span> <span class="nx">TodoView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

    <span class="c1">//... is a list tag.</span>
    <span class="nx">tagName</span><span class="o">:</span>  <span class="s2">&quot;li&quot;</span><span class="p">,</span>

    <span class="c1">// Cache the template function for a single item.</span>
    <span class="nx">template</span><span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#item-template&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">()),</span>

    <span class="c1">// The DOM events specific to an item.</span>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;click .toggle&quot;</span>   <span class="o">:</span> <span class="s2">&quot;toggleDone&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dblclick .view&quot;</span>  <span class="o">:</span> <span class="s2">&quot;edit&quot;</span><span class="p">,</span>
      <span class="s2">&quot;click a.destroy&quot;</span> <span class="o">:</span> <span class="s2">&quot;clear&quot;</span><span class="p">,</span>
      <span class="s2">&quot;keypress .edit&quot;</span>  <span class="o">:</span> <span class="s2">&quot;updateOnEnter&quot;</span><span class="p">,</span>
      <span class="s2">&quot;blur .edit&quot;</span>      <span class="o">:</span> <span class="s2">&quot;close&quot;</span>
    <span class="p">},</span>

    <span class="c1">// The TodoView listens for changes to its model, re-rendering. Since there&#39;s</span>
    <span class="c1">// a one-to-one correspondence between a **Todo** and a **TodoView** in this</span>
    <span class="c1">// app, we set a direct reference on the model for convenience.</span>
    <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">listenTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">,</span> <span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">listenTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">,</span> <span class="s1">&#39;destroy&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="c1">// Re-render the titles of the todo item.</span>
    <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">()));</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">toggleClass</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">));</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.edit&#39;</span><span class="p">);</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="c1">// Toggle the `&quot;done&quot;` state of the model.</span>
    <span class="nx">toggleDone</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">toggle</span><span class="p">();</span>
    <span class="p">},</span>

    <span class="c1">// Switch this view into `&quot;editing&quot;` mode, displaying the input field.</span>
    <span class="nx">edit</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;editing&quot;</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
    <span class="p">},</span>

    <span class="c1">// Close the `&quot;editing&quot;` mode, saving changes to the todo.</span>
    <span class="nx">close</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">();</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span><span class="nx">title</span><span class="o">:</span> <span class="nx">value</span><span class="p">});</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;editing&quot;</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="c1">// If you hit `enter`, we&#39;re through editing the item.</span>
    <span class="nx">updateOnEnter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">keyCode</span> <span class="o">==</span> <span class="mi">13</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
    <span class="p">},</span>

    <span class="c1">// Remove the item, destroy the model.</span>
    <span class="nx">clear</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
    <span class="p">}</span>

  <span class="p">});</span>
</code></pre></div>

<h3>APPView</h3>

<p>APPView 应用的主视图，管理应用的全局状态，依赖html模板引擎</p>

<div class="highlight"><pre><code class="javascript">   <span class="c1">// The Application</span>
  <span class="c1">// ---------------</span>

  <span class="c1">// Our overall **AppView** is the top-level piece of UI.</span>
  <span class="kd">var</span> <span class="nx">AppView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

    <span class="c1">// Instead of generating a new element, bind to the existing skeleton of</span>
    <span class="c1">// the App already present in the HTML.</span>
    <span class="nx">el</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#todoapp&quot;</span><span class="p">),</span>

    <span class="c1">// Our template for the line of statistics at the bottom of the app.</span>
    <span class="nx">statsTemplate</span><span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#stats-template&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">()),</span>

    <span class="c1">// Delegated events for creating new items, and clearing completed ones.</span>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;keypress #new-todo&quot;</span><span class="o">:</span>  <span class="s2">&quot;createOnEnter&quot;</span><span class="p">,</span>
      <span class="s2">&quot;click #clear-completed&quot;</span><span class="o">:</span> <span class="s2">&quot;clearCompleted&quot;</span><span class="p">,</span>
      <span class="s2">&quot;click #toggle-all&quot;</span><span class="o">:</span> <span class="s2">&quot;toggleAllComplete&quot;</span>
    <span class="p">},</span>

    <span class="c1">// At initialization we bind to the relevant events on the `Todos`</span>
    <span class="c1">// collection, when items are added or changed. Kick things off by</span>
    <span class="c1">// loading any preexisting todos that might be saved in *localStorage*.</span>
    <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#new-todo&quot;</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">allCheckbox</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#toggle-all&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">listenTo</span><span class="p">(</span><span class="nx">Todos</span><span class="p">,</span> <span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">addOne</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">listenTo</span><span class="p">(</span><span class="nx">Todos</span><span class="p">,</span> <span class="s1">&#39;reset&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">addAll</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">listenTo</span><span class="p">(</span><span class="nx">Todos</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">);</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">footer</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;footer&#39;</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">main</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#main&#39;</span><span class="p">);</span>

      <span class="nx">Todos</span><span class="p">.</span><span class="nx">fetch</span><span class="p">();</span>
    <span class="p">},</span>

    <span class="c1">// Re-rendering the App just means refreshing the statistics -- the rest</span>
    <span class="c1">// of the app doesn&#39;t change.</span>
    <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">done</span> <span class="o">=</span> <span class="nx">Todos</span><span class="p">.</span><span class="nx">done</span><span class="p">().</span><span class="nx">length</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">remaining</span> <span class="o">=</span> <span class="nx">Todos</span><span class="p">.</span><span class="nx">remaining</span><span class="p">().</span><span class="nx">length</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">Todos</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">footer</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">footer</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">statsTemplate</span><span class="p">({</span><span class="nx">done</span><span class="o">:</span> <span class="nx">done</span><span class="p">,</span> <span class="nx">remaining</span><span class="o">:</span> <span class="nx">remaining</span><span class="p">}));</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">footer</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span>
      <span class="p">}</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">allCheckbox</span><span class="p">.</span><span class="nx">checked</span> <span class="o">=</span> <span class="o">!</span><span class="nx">remaining</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="c1">// Add a single todo item to the list by creating a view for it, and</span>
    <span class="c1">// appending its element to the `&lt;ul&gt;`.</span>
    <span class="nx">addOne</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">view</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TodoView</span><span class="p">({</span><span class="nx">model</span><span class="o">:</span> <span class="nx">todo</span><span class="p">});</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#todo-list&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">view</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">el</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="c1">// Add all items in the **Todos** collection at once.</span>
    <span class="nx">addAll</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Todos</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">addOne</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="c1">// If you hit return in the main input field, create new **Todo** model,</span>
    <span class="c1">// persisting it to *localStorage*.</span>
    <span class="nx">createOnEnter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">keyCode</span> <span class="o">!=</span> <span class="mi">13</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">())</span> <span class="k">return</span><span class="p">;</span>

      <span class="nx">Todos</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">title</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">()});</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="c1">// Clear all done todo items, destroying their models.</span>
    <span class="nx">clearCompleted</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">_</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="nx">Todos</span><span class="p">.</span><span class="nx">done</span><span class="p">(),</span> <span class="s1">&#39;destroy&#39;</span><span class="p">);</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="nx">toggleAllComplete</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">done</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">allCheckbox</span><span class="p">.</span><span class="nx">checked</span><span class="p">;</span>
      <span class="nx">Todos</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span> <span class="nx">todo</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span><span class="s1">&#39;done&#39;</span><span class="o">:</span> <span class="nx">done</span><span class="p">});</span> <span class="p">});</span>
    <span class="p">}</span>

  <span class="p">});</span>
</code></pre></div>

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/lessons/2013/05/17/lightbox-test" title="lightbox test">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next disabled"><a>Next &rarr;</a>
      
      </ul>
    </div>
    <hr>
    
  </div>
  
  <div class="span4">
    <h4>Published</h4>
    <div class="date"><span>21 May 2013</span></div>

  
    <h4>Tags</h4>
    <ul class="tag_box">
    
    


  
     
    	<li><a href="/tags.html#backbone-ref">backbone <span>1</span></a></li>
     
    	<li><a href="/tags.html#todo-ref">todo <span>1</span></a></li>
    
  



    </ul>
    
  </div>
</div>


      </div>

      <footer>
        <p>&copy; crazyjune 2012 
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div> <!-- /container -->

    
  </body>
</html>

